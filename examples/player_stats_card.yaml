# Player Statistics Card
# Focuses on displaying career statistics in a clean format

type: markdown
title: Player Statistics
content: |
  {% set player = states('sensor.dribl_john_doe') %}
  {% set career_stats = state_attr('sensor.dribl_john_doe', 'career_stats') %}
  
  {% if career_stats %}
  <div style="text-align: center; margin-bottom: 20px;">
    {% if state_attr('sensor.dribl_john_doe', 'image') %}
    <img src="{{ state_attr('sensor.dribl_john_doe', 'image') }}" 
         style="width: 60px; height: 60px; border-radius: 50%; margin-bottom: 10px;" 
         onerror="this.style.display='none'" />
    {% endif %}
    <h2 style="margin: 0; color: #2196f3;">{{ player }}</h2>
  </div>

  <!-- Career Summary -->
  {% set total_games = career_stats | sum(attribute='games_played') %}
  {% set total_goals = career_stats | sum(attribute='goals') %}
  {% set total_yellow = career_stats | sum(attribute='yellow_cards') %}
  {% set total_red = career_stats | sum(attribute='red_cards') %}
  
  <div style="display: flex; justify-content: space-around; margin-bottom: 20px; background: #f5f5f5; padding: 15px; border-radius: 8px;">
    <div style="text-align: center;">
      <div style="font-size: 24px; font-weight: bold; color: #2196f3;">{{ total_games }}</div>
      <div style="color: #666; font-size: 12px;">Games</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 24px; font-weight: bold; color: #4caf50;">{{ total_goals }}</div>
      <div style="color: #666; font-size: 12px;">Goals</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 24px; font-weight: bold; color: #ff9800;">{{ total_yellow }}</div>
      <div style="color: #666; font-size: 12px;">Yellow Cards</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 24px; font-weight: bold; color: #f44336;">{{ total_red }}</div>
      <div style="color: #666; font-size: 12px;">Red Cards</div>
    </div>
  </div>

  <!-- Season by Season -->
  <h3 style="color: #2196f3; margin-bottom: 10px;">Season by Season</h3>
  <div style="max-height: 300px; overflow-y: auto;">
    {% for stat in career_stats %}
    <div style="background: {% if loop.index % 2 == 0 %}#f9f9f9{% else %}white{% endif %}; padding: 10px; margin-bottom: 5px; border-radius: 5px; border-left: 4px solid #2196f3;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <strong>{{ stat.season_name if stat.season_name else 'Unknown Season' }}</strong>
          {% if stat.competition_name %}
          <br><small style="color: #666;">{{ stat.competition_name }}</small>
          {% endif %}
        </div>
        <div style="display: flex; gap: 15px; text-align: center;">
          <div>
            <div style="font-weight: bold;">{{ stat.games_played if stat.games_played else 0 }}</div>
            <div style="font-size: 10px; color: #666;">Games</div>
          </div>
          <div>
            <div style="font-weight: bold; color: #4caf50;">{{ stat.goals if stat.goals else 0 }}</div>
            <div style="font-size: 10px; color: #666;">Goals</div>
          </div>
          {% if stat.yellow_cards %}
          <div>
            <div style="font-weight: bold; color: #ff9800;">{{ stat.yellow_cards }}</div>
            <div style="font-size: 10px; color: #666;">ðŸŸ¨</div>
          </div>
          {% endif %}
          {% if stat.red_cards %}
          <div>
            <div style="font-weight: bold; color: #f44336;">{{ stat.red_cards }}</div>
            <div style="font-size: 10px; color: #666;">ðŸŸ¥</div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  
  {% else %}
  <div style="text-align: center; padding: 20px; color: #666;">
    <div style="font-size: 48px; margin-bottom: 10px;">ðŸ“Š</div>
    <div>No statistics available</div>
    <small>Career statistics may not be available for this player</small>
  </div>
  {% endif %}